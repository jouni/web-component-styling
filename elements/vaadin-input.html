<dom-module id="vaadin-input">
  <template>
    <style>
      :host {
        display: inline-flex;
        flex-direction: column;

        @apply(--theme);
      }

      input {
        order: 2;
        @apply(--theme__input);
        @apply(--input);
      }

      input::-webkit-input-placeholder {
        @apply(--theme__input--placeholder);
        @apply(--input--placeholder);
      }

      input:focus {
        @apply(--theme__input--focus);
        @apply(--input--focus);
      }

      label {
        @apply(--theme__label);
        @apply(--label);
      }

      input:focus ~ label {
        @apply(--theme__label--focus);
        @apply(--label--focus);
      }

      .error {
        order: 3;
        margin: 0;
        @apply(--theme__error);
        @apply(--error);
      }

      input:focus ~ .error {
        @apply(--theme__error--focus);
        @apply(--error--focus);
      }

      input:valid ~ label {
        @apply(--theme__label--input-has-value);
        @apply(--label--input-has-value);
      }
    </style>
    <input value="[[value]]" id$="[[_id]]" placeholder="[[placeholder]]" required>
    <template is="dom-if" if="[[label]]" restamp="true">
      <label for$="[[_id]]">[[label]]</label>
    </template>
    <template is="dom-if" if="[[error]]" restamp="true">
      <p class="error">[[error]]</p>
    </template>
  </template>
  <script>
    Polymer({
      is: 'vaadin-input',
      properties: {
        _id: {
          type: String,
          computed: "_computeId(label)"
        },
        label: {
          type: String,
          reflectToAttribute: true
        },
        placeholder: {
          type: String,
          reflectToAttribute: true
        },
        value: {
          type: String,
          reflectToAttribute: true
        },
        error: {
          type: String,
          reflectToAttribute: true
        }
      },
      _computeId: function(label) {
        return "vaadin-input-" + Math.round(Math.random() * 100);
      }
    });

  </script>
</dom-module>
