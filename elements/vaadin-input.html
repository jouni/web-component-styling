<link rel="import" href="../bower_components/polymer/polymer-element.html">

<dom-module id="vaadin-input">
  <template>
    <style>
      :host {
        display: inline-flex;
        flex-direction: column;
        @apply --vaadin-input;
      }

      :host(.vaadin-input--focus) {
        @apply --vaadin-input--focus;
      }

      input {
        background: transparent;
        color: inherit;
        font: inherit;
        border: 0;
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        @apply --vaadin-input__input;
      }

      input::-webkit-input-placeholder {
        color: inherit;
        opacity: 0.4;
        @apply --vaadin-input__input--placeholder;
      }

      input:focus {
        @apply --vaadin-input__input--focus;
      }

      label {
        @apply --vaadin-input__label;
      }

      input:focus ~ label {
        @apply --vaadin-input__label--focus;
      }

      input:valid ~ label {
        @apply --vaadin-input__label--input-has-value;
      }
    </style>
    <label></label>
    <input>
  </template>
  <script>
    class VaadinInput extends Polymer.Element {
      static get is() {
        return "vaadin-input";
      }

      ready() {
        super.ready();

        var input = this.root.querySelector("input");
        var label = this.root.querySelector("label");

        input.id = this._computeId();
        label.setAttribute("for", input.id);

        if (this.hasAttribute("label")) {
          label.innerText = this.getAttribute("label");
        }

        if (this.hasAttribute("placeholder")) {
          input.placeholder = this.getAttribute("placeholder");
        }

        input.addEventListener("input", (e) => this._input(e));
      }

      _computeId() {
        return "vaadin-input-" + Math.round(Math.random() * 100);
      }

      _input(e) {
        this.toggleClass("vaadin-input--has-value", e.target.value !== "");
      }

      _focus(e) {
        this.toggleClass("vaadin-input--focus", true);
      }

      _blur(e) {
        this.toggleClass("vaadin-input--focus", false);
      }
    }

    customElements.define(VaadinInput.is, VaadinInput);

  </script>
</dom-module>
